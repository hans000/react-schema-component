import{r as l,q as I,aQ as dt,aK as Ae,af as ft,B as Le,R as S,s as ze,u as pt,y as te,a8 as vt,c as ne,x as y,g as gt,k as Be,t as mt,U as xt,a as ht,ab as bt}from"./index-7e4a4b07.js";import{B as St,T as Ct}from"./TextArea-386dd94b.js";import{g as wt}from"./PurePanel-881ad915.js";import{g as yt,a as It}from"./statusUtils-603cf288.js";import{D as Ot}from"./defaultRenderEmpty-c1d6a389.js";import ke from"./index-111dbef7.js";import{i as Et,b as Pt,c as _t,d as Nt,g as Mt,f as Rt}from"./index-6cf728da.js";import"./index-d633e674.js";import"./useLocale-67a063e1.js";import"./index-87e7e444.js";import"./compact-item-94a971d4.js";function Tt(){var e=l.useState({id:0,callback:null}),t=I(e,2),i=t[0],n=t[1],a=l.useCallback(function(u){n(function(r){var c=r.id;return{id:c+1,callback:u}})},[]);return l.useEffect(function(){var u;(u=i.callback)===null||u===void 0||u.call(i)},[i]),a}var Ke=l.createContext(null);function $t(e){var t=l.useContext(Ke),i=t.notFoundContent,n=t.activeIndex,a=t.setActiveIndex,u=t.selectOption,r=t.onFocus,c=t.onBlur,v=e.prefixCls,p=e.options,b=p[n]||{};return l.createElement(dt,{prefixCls:"".concat(v,"-menu"),activeKey:b.key,onSelect:function(C){var g=C.key,x=p.find(function(h){var w=h.key;return w===g});u(x)},onFocus:r,onBlur:c},p.map(function(m,C){var g=m.key,x=m.disabled,h=m.className,w=m.style,O=m.label;return l.createElement(Ae,{key:g,disabled:x,className:h,style:w,onMouseEnter:function(){a(C)}},O)}),!p.length&&l.createElement(Ae,{disabled:!0},i))}var Ft={bottomRight:{points:["tl","br"],offset:[0,4],overflow:{adjustX:1,adjustY:1}},bottomLeft:{points:["tr","bl"],offset:[0,4],overflow:{adjustX:1,adjustY:1}},topRight:{points:["bl","tr"],offset:[0,-4],overflow:{adjustX:1,adjustY:1}},topLeft:{points:["br","tl"],offset:[0,-4],overflow:{adjustX:1,adjustY:1}}},jt=function(t){var i=t.prefixCls,n=t.options,a=t.children,u=t.visible,r=t.transitionName,c=t.getPopupContainer,v=t.dropdownClassName,p=t.direction,b=t.placement,m="".concat(i,"-dropdown"),C=l.createElement($t,{prefixCls:m,options:n}),g=l.useMemo(function(){var x;return p==="rtl"?x=b==="top"?"topLeft":"bottomLeft":x=b==="top"?"topRight":"bottomRight",x},[p,b]);return l.createElement(ft,{prefixCls:m,popupVisible:u,popup:C,popupPlacement:g,popupTransitionName:r,builtinPlacements:Ft,getPopupContainer:c,popupClassName:v},a)},At=function(){return null};function Bt(e){var t=e.selectionStart;return e.value.slice(0,t)}function kt(e,t){return t.reduce(function(i,n){var a=e.lastIndexOf(n);return a>i.location?{location:a,prefix:n}:i},{location:-1,prefix:""})}function De(e){return(e||"").toLowerCase()}function Dt(e,t,i){var n=e[0];if(!n||n===i)return e;for(var a=e,u=t.length,r=0;r<u;r+=1)if(De(a[r])!==De(t[r])){a=a.slice(r);break}else r===u-1&&(a=a.slice(u));return a}function Lt(e,t){var i=t.measureLocation,n=t.prefix,a=t.targetText,u=t.selectionStart,r=t.split,c=e.slice(0,i);c[c.length-r.length]===r&&(c=c.slice(0,c.length-r.length)),c&&(c="".concat(c).concat(r));var v=Dt(e.slice(u),a.slice(u-i-n.length),r);v.slice(0,r.length)===r&&(v=v.slice(r.length));var p="".concat(c).concat(n).concat(a).concat(r);return{text:"".concat(p).concat(v),selectionLocation:p.length}}function zt(e,t){e.setSelectionRange(t,t),e.blur(),e.focus()}function Kt(e,t){return!t||e.indexOf(t)===-1}function Ht(e,t){var i=t.value,n=i===void 0?"":i,a=e.toLowerCase();return n.toLowerCase().indexOf(a)!==-1}var Wt=["prefixCls","className","style","prefix","split","notFoundContent","value","defaultValue","children","options","open","validateSearch","filterOption","onChange","onKeyDown","onKeyUp","onPressEnter","onSearch","onSelect","onFocus","onBlur","transitionName","placement","direction","getPopupContainer","dropdownClassName","rows"],Ut=["suffix","prefixCls","classes","value"],Vt=l.forwardRef(function(e,t){var i=e.prefixCls,n=i===void 0?"rc-mentions":i,a=e.className,u=e.style,r=e.prefix,c=r===void 0?"@":r,v=e.split,p=v===void 0?" ":v,b=e.notFoundContent,m=b===void 0?"Not Found":b,C=e.value,g=e.defaultValue,x=e.children,h=e.options,w=e.open,O=e.validateSearch,W=O===void 0?Kt:O,P=e.filterOption,M=P===void 0?Ht:P,A=e.onChange,R=e.onKeyDown,B=e.onKeyUp,U=e.onPressEnter,V=e.onSearch,k=e.onSelect,X=e.onFocus,D=e.onBlur,re=e.transitionName,ae=e.placement,E=e.direction,ie=e.getPopupContainer,L=e.dropdownClassName,Y=e.rows,se=Y===void 0?1:Y,We=Le(e,Wt),G=Array.isArray(c)?c:[c],z=l.useRef(null),le=l.useRef(null),ue=function(){var o,s;return(o=z.current)===null||o===void 0||(s=o.resizableTextArea)===null||s===void 0?void 0:s.textArea};S.useImperativeHandle(t,function(){var f,o;return{focus:function(){var d;return(d=z.current)===null||d===void 0?void 0:d.focus()},blur:function(){var d;return(d=z.current)===null||d===void 0?void 0:d.blur()},textarea:(f=z.current)===null||f===void 0||(o=f.resizableTextArea)===null||o===void 0?void 0:o.textArea}});var Ue=l.useState(!1),me=I(Ue,2),q=me[0],xe=me[1],Ve=l.useState(""),he=I(Ve,2),be=he[0],Se=he[1],Xe=l.useState(""),Ce=I(Xe,2),we=Ce[0],Ye=Ce[1],Ge=l.useState(0),ye=I(Ge,2),Ie=ye[0],Oe=ye[1],qe=l.useState(0),Ee=I(qe,2),ce=Ee[0],de=Ee[1],Qe=l.useState(!1),Pe=I(Qe,2),Je=Pe[0],_e=Pe[1],Ze=pt("",{defaultValue:g,value:C}),Ne=I(Ze,2),T=Ne[0],et=Ne[1];l.useEffect(function(){q&&le.current&&(le.current.scrollTop=ue().scrollTop)},[q]);var tt=S.useMemo(function(){if(w)for(var f=0;f<G.length;f+=1){var o=G[f],s=T.lastIndexOf(o);if(s>=0)return[!0,"",o,s]}return[q,be,we,Ie]},[w,q,G,T,be,we,Ie]),Q=I(tt,4),$=Q[0],fe=Q[1],J=Q[2],pe=Q[3],ve=S.useCallback(function(f){var o;return h&&h.length>0?o=h.map(function(s){var d;return te(te({},s),{},{key:(d=s?.key)!==null&&d!==void 0?d:s.value})}):o=vt(x).map(function(s){var d=s.props,_=s.key;return te(te({},d),{},{label:d.children,key:_||d.value})}),o.filter(function(s){return M===!1?!0:M(f,s)})},[x,h,M]),Z=S.useMemo(function(){return ve(fe)},[ve,fe]),nt=Tt(),ot=function(o,s,d){xe(!0),Se(o),Ye(s),Oe(d),de(0)},F=function(o){xe(!1),Oe(0),Se(""),nt(o)},Me=function(o){et(o),A?.(o)},rt=function(o){var s=o.target.value;Me(s)},Re=function(o){var s,d=o.value,_=d===void 0?"":d,N=Lt(T,{measureLocation:pe,targetText:_,prefix:J,selectionStart:(s=ue())===null||s===void 0?void 0:s.selectionStart,split:p}),j=N.text,K=N.selectionLocation;Me(j),F(function(){zt(ue(),K)}),k?.(o,J)},at=function(o){var s=o.which;if(R?.(o),!!$){if(s===y.UP||s===y.DOWN){var d=Z.length,_=s===y.UP?-1:1,N=(ce+_+d)%d;de(N),o.preventDefault()}else if(s===y.ESC)F();else if(s===y.ENTER){if(o.preventDefault(),!Z.length){F();return}var j=Z[ce];Re(j)}}},it=function(o){var s=o.key,d=o.which,_=o.target,N=Bt(_),j=kt(N,G),K=j.location,ee=j.prefix;if(B?.(o),[y.ESC,y.UP,y.DOWN,y.ENTER].indexOf(d)===-1)if(K!==-1){var H=N.slice(K+ee.length),je=W(H,p),ct=!!ve(H).length;je?(s===ee||s==="Shift"||$||H!==fe&&ct)&&ot(H,ee,K):$&&F(),V&&je&&V(H,ee)}else $&&F()},st=function(o){!$&&U&&U(o)},Te=l.useRef(),$e=function(o){window.clearTimeout(Te.current),!Je&&o&&X&&X(o),_e(!0)},Fe=function(o){Te.current=window.setTimeout(function(){_e(!1),F(),D?.(o)},0)},lt=function(){$e()},ut=function(){Fe()};return S.createElement("div",{className:ne(n,a),style:u},S.createElement(Ct,ze({ref:z,value:T},We,{rows:se,onChange:rt,onKeyDown:at,onKeyUp:it,onPressEnter:st,onFocus:$e,onBlur:Fe})),$&&S.createElement("div",{ref:le,className:"".concat(n,"-measure")},T.slice(0,pe),S.createElement(Ke.Provider,{value:{notFoundContent:m,activeIndex:ce,setActiveIndex:de,selectOption:Re,onFocus:lt,onBlur:ut}},S.createElement(jt,{prefixCls:n,transitionName:re,placement:ae,direction:E,options:Z,visible:!0,getPopupContainer:ie,dropdownClassName:L},S.createElement("span",null,J))),T.slice(pe+J.length)))}),ge=l.forwardRef(function(e,t){var i=e.suffix,n=e.prefixCls,a=e.classes,u=e.value,r=Le(e,Ut);return S.createElement(St,{inputElement:S.createElement(Vt,ze({prefixCls:n,ref:t},r)),suffix:i,prefixCls:n,classes:a,value:u})});ge.Option=At;const Xt=e=>{const{componentCls:t,colorTextDisabled:i,controlItemBgHover:n,controlPaddingHorizontal:a,colorText:u,motionDurationSlow:r,lineHeight:c,controlHeight:v,inputPaddingHorizontal:p,inputPaddingVertical:b,fontSize:m,colorBgElevated:C,paddingXXS:g,borderRadius:x,borderRadiusLG:h,boxShadowSecondary:w}=e,O=Math.round((e.controlHeight-e.fontSize*e.lineHeight)/2);return{[t]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Be(e)),Pt(e)),{position:"relative",display:"inline-block",height:"auto",padding:0,overflow:"hidden",lineHeight:c,whiteSpace:"pre-wrap",verticalAlign:"bottom"}),_t(e,t)),{"&-disabled":{"> textarea":Object.assign({},Nt(e))},"&-focused":Object.assign({},Mt(e)),[`&-affix-wrapper ${t}-suffix`]:{position:"absolute",top:0,insetInlineEnd:p,bottom:0,zIndex:1,display:"inline-flex",alignItems:"center",margin:"auto"},[`> textarea, ${t}-measure`]:{color:u,boxSizing:"border-box",minHeight:v-2,margin:0,padding:`${b}px ${p}px`,overflow:"inherit",overflowX:"hidden",overflowY:"auto",fontWeight:"inherit",fontSize:"inherit",fontFamily:"inherit",fontStyle:"inherit",fontVariant:"inherit",fontSizeAdjust:"inherit",fontStretch:"inherit",lineHeight:"inherit",direction:"inherit",letterSpacing:"inherit",whiteSpace:"inherit",textAlign:"inherit",verticalAlign:"top",wordWrap:"break-word",wordBreak:"inherit",tabSize:"inherit"},"> textarea":Object.assign({width:"100%",border:"none",outline:"none",resize:"none",backgroundColor:"inherit"},Rt(e.colorTextPlaceholder)),[`${t}-measure`]:{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,zIndex:-1,color:"transparent",pointerEvents:"none","> span":{display:"inline-block",minHeight:"1em"}},"&-dropdown":Object.assign(Object.assign({},Be(e)),{position:"absolute",top:-9999,insetInlineStart:-9999,zIndex:e.zIndexPopup,boxSizing:"border-box",fontSize:m,fontVariant:"initial",padding:g,backgroundColor:C,borderRadius:h,outline:"none",boxShadow:w,"&-hidden":{display:"none"},[`${t}-dropdown-menu`]:{maxHeight:e.dropdownHeight,margin:0,paddingInlineStart:0,overflow:"auto",listStyle:"none",outline:"none","&-item":Object.assign(Object.assign({},mt),{position:"relative",display:"block",minWidth:e.controlItemWidth,padding:`${O}px ${a}px`,color:u,borderRadius:x,fontWeight:"normal",lineHeight:c,cursor:"pointer",transition:`background ${r} ease`,"&:hover":{backgroundColor:n},"&-disabled":{color:i,cursor:"not-allowed","&:hover":{color:i,backgroundColor:n,cursor:"not-allowed"}},"&-selected":{color:u,fontWeight:e.fontWeightStrong,backgroundColor:n},"&-active":{backgroundColor:n}})}})})}},Yt=gt("Mentions",e=>{const t=Et(e);return[Xt(t)]},e=>({dropdownHeight:250,controlItemWidth:100,zIndexPopup:e.zIndexPopupBase+50}));var Gt=globalThis&&globalThis.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(i[n[a]]=e[n[a]]);return i};const{Option:He}=ge;function qt(){return!0}const Qt=(e,t)=>{var{prefixCls:i,className:n,rootClassName:a,disabled:u,loading:r,filterOption:c,children:v,notFoundContent:p,options:b,status:m,popupClassName:C}=e,g=Gt(e,["prefixCls","className","rootClassName","disabled","loading","filterOption","children","notFoundContent","options","status","popupClassName"]);const[x,h]=l.useState(!1),w=l.useRef(null),O=xt(t,w),{getPrefixCls:W,renderEmpty:P,direction:M}=l.useContext(ht),{status:A,hasFeedback:R,feedbackIcon:B}=l.useContext(bt),U=It(A,m),V=function(){g.onFocus&&g.onFocus.apply(g,arguments),h(!0)},k=function(){g.onBlur&&g.onBlur.apply(g,arguments),h(!1)},X=l.useMemo(()=>p!==void 0?p:P?.("Select")||l.createElement(Ot,{componentName:"Select"}),[p,P]),D=l.useMemo(()=>r?l.createElement(He,{value:"ANTD_SEARCHING",disabled:!0},l.createElement(ke,{size:"small"})):v,[r,v]),re=r?[{value:"ANTD_SEARCHING",disabled:!0,label:l.createElement(ke,{size:"small"})}]:b,ae=r?qt:c,E=W("mentions",i),[ie,L]=Yt(E),Y=ne({[`${E}-disabled`]:u,[`${E}-focused`]:x,[`${E}-rtl`]:M==="rtl"},yt(E,U),!R&&n,a,L),se=l.createElement(ge,Object.assign({prefixCls:E,notFoundContent:X,className:Y,disabled:u,direction:M},g,{filterOption:ae,onFocus:V,onBlur:k,dropdownClassName:ne(C,a,L),ref:O,options:re,suffix:R&&B,classes:{affixWrapper:ne(L,n)}}),D);return ie(se)},oe=l.forwardRef(Qt);oe.Option=He;const Jt=wt(oe,"mentions");oe._InternalPanelDoNotUseOrYouWillBeFired=Jt;oe.getMentions=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{prefix:i="@",split:n=" "}=t,a=Array.isArray(i)?i:[i];return e.split(n).map(function(){let u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=null;return a.some(c=>u.slice(0,c.length)===c?(r=c,!0):!1),r!==null?{prefix:r,value:u.slice(r.length)}:null}).filter(u=>!!u&&!!u.value)};export{He as Option,oe as default};
